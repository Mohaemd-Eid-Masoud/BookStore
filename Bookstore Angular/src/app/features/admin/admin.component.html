<div class="centered-container">
  <a routerLink="/" class="home-link">ğŸ  Home</a>
  <section id="books" class="section">
    <h2>ğŸ“š Book Management</h2>
    <p>Manage your bookstore inventory - add, edit, and organize books.</p>
    <div *ngIf="books.length === 0" class="no-data">No books available. Click the button to load!</div>
    <ul class="book-list">
      <li *ngFor="let book of books" class="book-item">
        <app-card [title]="book.name" [showFooter]="true">
          <p><strong>Author:</strong> <span class="author">{{ book.author }}</span></p>
          <p><strong>Description:</strong> {{ book.description }}</p>
          <p><strong>Price:</strong> <span class="price">${{ book.value }}</span></p>
          <p><strong>Published:</strong> {{ book.publishDate }}</p>
          <div footer>
            <button (click)="openBookForm(book)" class="edit-btn" title="Edit this book">âœï¸ Edit</button>
            <button (click)="deleteBook(book.id!)" class="delete-btn" title="Delete this book">ğŸ—‘ï¸ Delete</button>
            <button
              (click)="addToCart(book)"
              class="add-to-cart-btn"
              [disabled]="addingToCartBookId === book.id"
              [class.loading]="addingToCartBookId === book.id"
              title="Add to cart">
              <span *ngIf="addingToCartBookId === book.id" class="loading-spinner">
                <i class="fas fa-spinner fa-spin"></i>
              </span>
              <span *ngIf="addingToCartBookId !== book.id">ğŸ›’</span>
              {{ addingToCartBookId === book.id ? 'Adding...' : 'Add to Cart' }}
            </button>
          </div>
        </app-card>
      </li>
    </ul>
    <button (click)="loadBooks()" class="load-btn">ğŸ“š Load Books</button>
    <button (click)="openBookForm()" class="add-btn">â• Add Book</button>
    <form (ngSubmit)="submitBook()" *ngIf="showBookForm">
      <h3 class="form-title">{{ editingBook ? 'Edit' : 'Add' }} Book</h3>
      <div class="form-group">
        <label for="bookName">Book Name</label>
        <input id="bookName" type="text" [(ngModel)]="bookForm.name" name="name" placeholder="Enter book name" required>
      </div>
      <div class="form-group">
        <label for="bookAuthor">Author</label>
        <input id="bookAuthor" type="text" [(ngModel)]="bookForm.author" name="author" placeholder="Enter author name" required>
      </div>
      <div class="form-group">
        <label for="bookDescription">Description</label>
        <textarea id="bookDescription" [(ngModel)]="bookForm.description" name="description" placeholder="Enter book description" required></textarea>
      </div>
      <div class="form-group">
        <label for="bookValue">Price ($)</label>
        <input id="bookValue" type="number" [(ngModel)]="bookForm.value" name="value" placeholder="Enter price" step="0.01" min="0" required>
      </div>
      <div class="form-group">
        <label for="bookPublishDate">Publication Date</label>
        <input id="bookPublishDate" type="date" [(ngModel)]="bookForm.publishDate" name="publishDate" required>
      </div>
      <div class="form-group">
        <label for="bookCategory">Category</label>
        <select id="bookCategory" [(ngModel)]="bookForm.categoryId" name="categoryId" required>
          <option value="0">Select Category</option>
          <option *ngFor="let cat of categories" [value]="cat.id">{{ cat.name }}</option>
        </select>
      </div>
      <button type="submit">{{ editingBook ? 'ğŸ’¾ Update' : 'â• Create' }}</button>
      <button type="button" (click)="cancelBookEdit()">âŒ Cancel</button>
    </form>
  </section>

  <section id="categories" class="section">
    <h2>ğŸ·ï¸ Categories</h2>
    <div *ngIf="categories.length === 0" class="no-data">No categories available.</div>
    <ul class="category-list">
      <li *ngFor="let category of categories" class="category-item">
        <span>{{ category.name }}</span>
        <button (click)="openCategoryForm(category)" class="edit-btn" title="Edit this category">âœï¸ Edit</button>
        <button (click)="deleteCategory(category.id!)" class="delete-btn" title="Delete this category">ğŸ—‘ï¸ Delete</button>
        <button (click)="filterBooksByCategory(category.id!)" class="filter-btn" title="View books in this category">ğŸ‘ï¸ View Books</button>
      </li>
    </ul>
    <button (click)="openCategoryForm()" class="add-btn">â• Add Category</button>
    <form (ngSubmit)="submitCategory()" *ngIf="showCategoryForm">
      <h3>{{ editingCategory ? 'Edit' : 'Add' }} Category</h3>
      <input type="text" [(ngModel)]="categoryForm.name" name="name" placeholder="Category Name" required>
      <button type="submit">{{ editingCategory ? 'ğŸ’¾ Update' : 'â• Create' }}</button>
      <button type="button" (click)="cancelCategoryEdit()">âŒ Cancel</button>
    </form>
  </section>
</div>

<!-- Global Notifications -->
<app-notification></app-notification>

<!-- Global Confirmation Modal -->
<app-confirmation-modal></app-confirmation-modal>
